<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ApnaOPD</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by freehtml5.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="freehtml5.co" />


  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	
	<!-- <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,500,700,800" rel="stylesheet">	 -->
	<link href="https://fonts.googleapis.com/css?family=Space+Mono" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->

	<!-- <script>
		var GID =sessionStorage.getItem("gid");
		if(GID == null || GID == '' || GID == undefined )
		{
			window.location.href = "index.html";
		}
	
	
	</script> -->

	<style>
		#appointmentList::-webkit-scrollbar {
		    width: 6px;
		}

		/* Track */
		#appointmentList::-webkit-scrollbar-track {
		    box-shadow: inset 0 0 5px grey; 
		    border-radius: 10px;
		}
		 
		/* Handle */
		#appointmentList::-webkit-scrollbar-thumb {
		    background: green; 
		    border-radius: 10px;
		}

		/* Handle on hover */
		#appointmentList::-webkit-scrollbar-thumb:hover {
		    background: #b30000; 
		}

		#appointment_body, #order_body {
			border: 1px solid #ddd;
			padding: 20px;
			margin-bottom: 15px;
		}


		#orderList::-webkit-scrollbar {
		    width: 6px;
		}

		/* Track */
		#orderList::-webkit-scrollbar-track {
		    box-shadow: inset 0 0 5px grey; 
		    border-radius: 10px;
		}
		 
		/* Handle */
		#orderList::-webkit-scrollbar-thumb {
		    background: green; 
		    border-radius: 10px;
		}

		/* Handle on hover */
		#orderList::-webkit-scrollbar-thumb:hover {
		    background: #b30000; 
		}

		.nav-tabs li {
			width: 25%;
			text-align: center;
			font-size: 20px;
			font-weight: bold;
		}

		.nav-tabs li.active a {
			color: #00960c;
		}

		.nav-tabs li a {
			color: #000;
		}

		.services {
			xbackground-color: aliceblue;
			border: 1px solid aliceblue;
		}

		.services:hover {
			box-shadow: 2px 2px 8px 1px aliceblue;
		}

		.services h3 {
			border-bottom: 1px solid #eee;
			padding-bottom: 15px;
		}
	</style>
	<!-- <script>
		function signOut() {
		var auth2 = gapi.auth2.getAuthInstance();

		var profile = auth2.currentUser.get().getBasicProfile();
			console.log('ID: ' + profile.getId());
			gid = profile.getId();
			console.log('Full Name: ' + profile.getName());
			console.log('Given Name: ' + profile.getGivenName());
			console.log('Family Name: ' + profile.getFamilyName());
			console.log('Image URL: ' + profile.getImageUrl());
			console.log('Email: ' + profile.getEmail());

			auth2.signOut().then(function () {
				console.log('User signed out.');
			});
		}

		function onLoad() {
		gapi.load('auth2', function() {
			auth2 = gapi.auth2.init({
				client_id: '107539492045-0nisvu97nie1525hget5baddnfufbhb8.apps.googleusercontent.com',
				fetch_basic_profile: true,
				scope: 'profile'
			});

			// Sign the user in, and then retrieve their ID.
				auth2.signIn().then(function() {
					console.log(auth2.currentUser.get().getId());
				});
			});

		}
	
	</script> -->

	</head>
	<body>
		
	<div class="fh5co-loader"></div>
	
	<div id="page">
	<nav class="fh5co-nav" role="navigation">
		<div class="top-menu">
			<div class="container-fluid">
				<div class="row">
					<div class="col-xs-2">
						<div id="fh5co-logo"><a href="index.html">ApnaOPD</a></div>
					</div>
					<div class="col-xs-10 text-right menu-1">
						<ul>
							<li><a href="index.html">Home</a></li>
							<!-- <li><a href="product.html">Product</a></li> -->
							<li  class="active"><a onclick="patient_login()" href="#" >Patient</a></li>
							<li><a onclick="doctor_login()" href="#">Doctor</a></li>
							<li><a onclick="retailer_login()" href="#">Retailer</a></li>
							
						</ul>
					</div>
				</div>
				
			</div>
		</div>
	</nav>


<!-- tabs -->
<div class="container-fluid">
<ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#services">Services</a></li>
    <li><a data-toggle="tab" href="#appointments">My Appointments</a></li>
    <li><a data-toggle="tab" href="#orders">My Orders</a></li>
    <li><a data-toggle="tab" href="#profile">Profile</a></li>
  </ul>

  <div class="tab-content">
    <div id="services" class="tab-pane fade in active">
      <div id="fh5co-services">
		<div class="container">
			<div class="row">
				<div class="col-md-4 text-center animate-box">
					<div class="services">
						<a href="book_appointment.html">
						<span class="icon">
							<i class="icon-calendar"></i>
						</span>
						<div class="desc">
							<h3>Book Appointment</h3>
							<p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus 
								alias autem provident. Odit ab aliquam dolor eius.</p>
						</div>
						</a>
					</div>
				</div>
				<div class="col-md-4 text-center animate-box">
					<div class="services">
						<a href="order_medicine.html">
						<span class="icon">
							<i class="icon-shopping-cart"></i>
						</span>
						<div class="desc">
							<h3>Order Medicines</h3>
							<p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus 
								alias autem provident. Odit ab aliquam dolor eius.</p>
						</div>
						</a>
					</div>
				</div>
				<div class="col-md-4 text-center animate-box">
					<div class="services">
						<a href="pathology.html">
						<span class="icon">
							<i class="icon-lab-flask"></i>
						</span>
						<div class="desc">
							<h3>Pathology</h3>
							<p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus
								 alias autem provident. Odit ab aliquam dolor eius.</p>
						</div>
						</a>
					</div>
				</div>
			</div>
		</div>
	</div>
    </div>
    <div id="appointments" class="tab-pane fade">
      <div id="fh5co-about">
		<div class="container-fluid">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<h2>Appointments</h2>
					<!-- <p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p> -->
				</div>
			</div>
			<div class="row">
				<div class="member">
					<div class="col-md-3 nopadding animate-box">
					</div>
					<div class="col-md-6 nopadding animate-box">
						<div id="appointmentList" class="desc" style="margin-top:1em;height: 600px;margin-top:0;padding:1em;width:100%; overflow-y: auto;">
							<div id="appointment_body" style="border: 1px solid aliceblue;">
							<div class="row">
								<div class="col-md-9">
									<h3>[[patient_name]]</h3>
									<p>[[patient_age]]</p>
									<p>[[time]]</p>
								</div>
								<div class="col-md-3">
									<button class="btn btn-primary" onclick="appointmentDetail(this.id)" id="[[_id]]">View details</button>
								</div>
							</div>
							</div>
						</div>
					</div>
					<div class="col-md-3 nopadding animate-box">
					</div>
				</div>
			</div>
		</div>
	</div>
    </div>
    <div id="orders" class="tab-pane fade">
      <div id="fh5co-about">
		<div class="container-fluid">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<h2>Orders</h2>
					<!-- <p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p> -->
				</div>
			</div>
			<div class="row">
				<div class="member">
					<div class="col-md-3 nopadding animate-box">
					</div>
					<div class="col-md-6 nopadding animate-box">
						<div id="orderList" class="desc" style="margin-top:1em;height: 600px;margin-top:0;padding:1em;width:100%; overflow-y: auto;">
							<div id="order_body"  style="border: 1px solid white; background : white;">
							<div class="row">
								<div class="col-md-12">
									<!-- <h3>Order id : [[_id]]</h3> -->
									<p>Time of order : [[time]]</p>
									<p>Order Status : <span id="[[_id]]" style="padding: 8px; color: black; display: inline;">[[status]]</span> </p>
									<button class="btn btn-primary" onclick="orderDetail(this.id)" id="[[_id]]">View details</button>
									<button class="btn btn-primary" onclick="offerDetail(this.id)" id="[[_id]]">View offers</button>
								</div>
							</div>
							</div>
						</div>
					</div>
					<div class="col-md-3 nopadding animate-box">
					</div>
					
				</div>
			</div>
		</div>
	</div>
    </div>
    <div id="profile" class="tab-pane fade">
      <div class="row" style="padding : 50px 0">
		<div class="col-md-3">

		</div>
		<div class="col-md-6" style="background : #eee"> 
			<div id="profile_body" class="row" style="padding : 25px">
				<div class="col-md-3" style="border: 1px solid white">
					<img class="img-responsive" src="[[imageUrl]]" alt="">
				</div>
				<div class="col-md-9" style="border: 1px solid white;">
					<!-- patient details -->
					<h3>[[name]]</h3>
					<p>[[email]]</p>
					<p>Contact</p>
					<button id="add_address" onclick="showAddressForm()" class="btn btn-default">Add Address</button>

					<div class="row"  id="addAddress" style="display : none;">
						<div class="col-md-12">
							<form>
							<div class="form-group">
								<label for="usr">House Number :</label>
								<input type="text" class="form-control" name="house_no">
							</div>
							<div class="form-group">
								<label for="pwd">Landmark :</label>
								<input type="text" class="form-control" name="landmark">
							</div> 
							<div class="form-group">
								<label for="pwd">City :</label>
								<input type="text" class="form-control" name="city">
							</div> 
							<div class="form-group">
								<label for="pwd">State :</label>
								<input type="text" class="form-control" name="state">
							</div> 
							<div class="form-group">
								<label for="pwd">PINCODE :</label>
								<input type="text" class="form-control" name="pincode">
							</div>
							<button type="button" onclick="sendNewAddress()" class="btn btn-primary">Add</button>
							</form>
						</div>
					</div>


				</div>
			</div>

		</div>
		<div class="col-md-3">

		</div>
	  </div>
    </div>
  </div>

</div>




    <footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row row-pb-md">
				<div class="col-md-4 fh5co-widget">
					<h4>ApnaOPD</h4>
					<p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit.
						 Eos cumque dicta adipisci architecto culpa amet.</p>
				</div>
				<div class="col-md-4 col-md-push-1">
					<h4>Links</h4>
					<ul class="fh5co-footer-links">
						<li><a href="index.html">Home</a></li>
						<li><a href="#">About us</a></li>
					</ul>
				</div>

				<div class="col-md-4 col-md-push-1">
					<h4>Contact Information</h4>
					<ul class="fh5co-footer-links">
						<li>Adityapur ,Jamshedpur <br>JH  INDIA 831012</li>
						<li><a href="tel://1234567920">+ 1235 2355 98</a></li>
						<li><a href="mailto:info@yoursite.com">email : ApnaOPD</a></li>
					</ul>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block">&copy; 2018 ApnaOPD. All Rights Reserved.</small> 
						<!-- <small class="block">Designed by <a href="http://freehtml5.co/" target="_blank">FreeHTML5.co</a> 
							Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a></small> -->
					</p>
					<p>
						<ul class="fh5co-social-icons">
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li><a href="#"><i class="icon-dribbble"></i></a></li>
						</ul>
					</p>
				</div>
			</div>

		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>
	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>

	<!-- <script src="https://apis.google.com/js/platform.js?onload=onLoad" async defer></script> -->

	<!-- Main -->
	<script src="js/main.js"></script>
	<script src="js/login_module.js"></script>

	<script src="js/jquery.miranda.min.js"></script>


	<script>
	//console.log("outside");
	var gid = sessionStorage.getItem('patient_gid');

	function sendNewAddress() {
		var addrr = $("#addAddress form").serializeArray();
		var obj={};
		var finalObj={};
		console.log(addrr);
		for(i=0;i<addrr.length;i++)
		{
			obj[addrr[i].name] = addrr[i].value;
			//console.log(addrr[i].name, addrr[i].value);
		}
		//console.log(obj);
		finalObj["address"] = obj;
		//console.log(finalObj);

		$.ajax({
				type        : 'PUT', 
				url         : 'http://192.168.43.193:3000/api/users/address/new'+gid,
				data        : finalObj,
				dataType    : 'json',
				encode      : true
			})
			.done(function(data) {
				console.log(data);
				alert("Address added!");
				window.location.href = "profile_patient.html";
		});

	}

	function showAddressForm() {
		$("#add_address").hide();
		$('#addAddress').slideDown("slow");
	}

		$.get("http://192.168.43.193:3000/api/users/" + gid , function(res) {
			console.log("user", res);
			$("#profile_body").mirandajs(res);
		});

		$.ajax({
		            type        : 'GET', 
		            url         : 'http://192.168.43.193:3000/api/appointments/patient/'+gid
		            //data        : e_presc,
		            //dataType    : 'json',
		            //encode      : true
		        })
		        .done(function(data) {
		        	console.log(data);
		        	//console.log("inside");
		        	$("#appointmentList").mirandajs(data);
				});

		function appointmentDetail(selected_apid) {
			sessionStorage.setItem('apid', selected_apid);
			window.location.href="appointment_detail.html"
		}
		var orders;		
		$.ajax({
			type        : 'GET', 
			url         : 'http://192.168.43.193:3000/api/orders/patient/'+gid
			//data        : e_presc,
			//dataType    : 'json',
			//encode      : true
		})
		.done(function(data) {
			console.log('orders',data);
			orders = data;
			//console.log("inside");
			$("#orderList").mirandajs(data);
			
			display_status();
			
		});

		function orderDetail(selected_oid) {
			sessionStorage.setItem('order_id', selected_oid);
			window.location.href="order_detail.html";
		}
		function offerDetail(selected_oid) {
			sessionStorage.setItem('order_id', selected_oid);
			window.location.href="offer_detail.html";
		}

		function display_status (){

			orders.forEach(element => {
				var orderId = "#"+element._id;
				var get_status = $(orderId).text();
				console.log(get_status);
				if(get_status == 0)
				{
					$(orderId).text("under process");
					$(orderId).css("background-color", "red");
				}
				else if(get_status == 1)
				{
					$(orderId).text("order confirmed");
					$(orderId).css("background-color", "green");
				}
				else if(get_status == 2)
				{
					$(orderId).text("packaged");
					$(orderId).css("background-color", "yellow");
				}
				else if(get_status == 3)
				{
					$(orderId).text("out for delivery");
					$(orderId).css("background-color", "blue");
				}
			});

			// var check_status = $(".order_status").text();
			// console.log("status",check_status);
			// for(i=0;i<check_status.length;i++)
			// {
			// 	console.log('out',check_status[i]);
			// 	if(parseInt(check_status[i])==0)
			// 	{
			// 		$(".order_status").text("Under process");
			// 	}
			// 	else if(parseInt(check_status[i])==1)
			// 	{
			// 		console.log('in',check_status[i]);
			// 		$(".order_status").text("order confirmed");
			// 	}
				
			// }
			

		}



		
	</script>

	</body>
</html>