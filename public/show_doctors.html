<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ApnaOPD</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by freehtml5.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="freehtml5.co" />

  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,500,700,800" rel="stylesheet">	 -->
	<link href="https://fonts.googleapis.com/css?family=Space+Mono" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->
	<style>
		.doctorListItem {
			border: 1px solid #eee;
		    padding: 25px;
		    margin-bottom: 20px;
		}

		#doctors {
			height: 600px;
			overflow-y: auto;
		}

		/* width */
		#doctors::-webkit-scrollbar {
		    width: 6px;
		}

		/* Track */
		#doctors::-webkit-scrollbar-track {
		    box-shadow: inset 0 0 5px grey; 
		    border-radius: 10px;
		}
		 
		/* Handle */
		#doctors::-webkit-scrollbar-thumb {
		    background: green; 
		    border-radius: 10px;
		}

		/* Handle on hover */
		#doctors::-webkit-scrollbar-thumb:hover {
		    background: #b30000; 
		}
	</style>
	</head>
	<body>
		
	<div class="fh5co-loader"></div>
	
	<div id="page">
	<nav class="fh5co-nav" role="navigation">
		<div class="top-menu">
			<div class="container-fluid">
				<div class="row">
					<div class="col-xs-2">
						<div id="fh5co-logo"><a href="index.html">ApnaOPD</a></div>
					</div>
					<div class="col-xs-10 text-right menu-1">
						<ul>
							<li><a href="index.html">Home</a></li>
							<!-- <li><a href="product.html">Product</a></li> -->
							<li><a onclick="patient_login()" href="#" >Patient</a></li>
							<li class="active"><a onclick="doctor_login()" href="#">Doctor</a></li>
							<li><a onclick="retailer_login()" href="#">Retailer</a></li>
						
						</ul>
					</div>
				</div>
				
			</div>
		</div>
	</nav>
	


	<div id="fh5co-about">
		<div class="container">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<h2>Doctors List</h2>
					<!-- <p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p> -->
				</div>
			</div>
			<div class="row">
				<div class="member">
					<div class="col-md-1 nopadding animate-box">
					</div>
					<div class="col-md-10 nopadding animate-box">
						<div id="doctors"  class="desc" style="margin-top:1em;">
							<div class="doctorListItem">
								<h3>[[name]]</h3>
								<p>[[addr]]</p>
								<p>[[fee]]</p>
								<div class="row">
									<div class="col-md-4">
										<div class="form-group">
											<label for="day">Select day:</label>
											<select class="form-control" id="day">
												<option value="1" selected>monday</option>
												<option value="2">tuesday</option>
												<option value="3">wednesday</option>
												<option value="4">thursday</option>
												<option value="5">friday</option>
												<option value="6">saturday</option>
												<option value="7">sunday</option>
											</select>
										</div> 
									</div>
									<div class="col-md-4">
										<div class="form-group">
											<label for="period">Select period:</label>
											<select class="form-control" id="period">
												<option value="1" selected>morning</option>
												<option value="2">afternoon</option>
												<option value="3">evening</option>
												<option value="4">night</option>
											</select>
										</div> 
									</div>
									<div class="col-md-4">
										<button class="btn btn-primary" style="margin-top : 35px;" onclick="getTimeSlab(this.id)" id="[[_id]]">Get Time Slab</button>
									</div>
								</div>

								<div class="row">
									<div class="col-md-12">
										<form id="morning" style="display : none;">
											<label class="radio-inline">
												<input type="radio" id="m0" name="select" value="1">6 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="m1" name="select" value="2">7 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="m2" name="select" value="3">8 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="m3" name="select" value="4">9 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="m4" name="select" value="5">10 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="m5" name="select" value="6">11 AM
											</label>
										</form>
									
										<form id="afternoon" style="display: none;">
											<label class="radio-inline">
												<input type="radio" id="a0" name="select" value="1">12 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="a1" name="select" value="2">1 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="a2" name="select" value="3">2 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="a3" name="select" value="4">3 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="a4" name="select" value="5">4 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="a5" name="select" value="6">5 PM
											</label>
										</form>
						
										<form id="evening" style="display: none;">
											<label class="radio-inline">
												<input type="radio" id="e0" name="select" value="1">6 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="e1" name="select" value="2">7 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="e2" name="select" value="3">8 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="e3" name="select" value="4">9 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="e4" name="select" value="5">10 PM
											</label>
											<label class="radio-inline">
												<input type="radio" id="e5" name="select" value="6">11 PM
											</label>
										</form>
					
										<form id="night" style="display: none;">
											<label class="radio-inline">
												<input type="radio" id="n0" name="select" value="1">12 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="n1" name="select" value="2">1 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="n2" name="select" value="3">2 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="n3" name="select" value="4">3 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="n4" name="select" value="5">4 AM
											</label>
											<label class="radio-inline">
												<input type="radio" id="n5" name="select" value="6">5 AM
											</label>
										</form>
									</div>
								</div>
								<!-- <p id="doctor_id" hidden="true"></p> -->
								<button onclick="book_appointment(this.id)" id="[[gid]]" class="btn btn-primary">Book</button>
							</div>
                        </div>
                        

                        
                    </div>
                    <div class="col-md-1 nopadding animate-box">
                    </div>
                    
				</div>
                
                
				
			</div>
		</div>
	</div>


	<!-- Booking confirmation modal -->

	<div id="booking_info" class="modal fade" role="dialog">
	  <div class="modal-dialog">

	    <!-- Modal content-->
	    <div class="modal-content">
	      <div class="modal-header">
	        <button type="button" class="close" data-dismiss="modal">&times;</button>
	        <h4 class="modal-title">Appointment Confirmed</h4>
	      </div>
	      <div id="m_body" class="modal-body">
	      	<p>Appointment Id : [[_id]]</p>
	        <p>Time : [[time]]</p>
	      </div>
	      <div class="modal-footer">
	        <button type="button" class="btn btn-default" data-dismiss="modal" onclick="window.location.href='profile_patient.html';">Close</button>
	      </div>
	    </div>

	  </div>
	</div>



    <footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row row-pb-md">
				<div class="col-md-4 fh5co-widget">
					<h4>ApnaOPD</h4>
					<p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit. Eos cumque dicta adipisci architecto culpa amet.</p>
				</div>
				<div class="col-md-4 col-md-push-1">
					<h4>Links</h4>
					<ul class="fh5co-footer-links">
						<li><a href="index.html">Home</a></li>
						<li><a href="#">About us</a></li>
					</ul>
				</div>

				<div class="col-md-4 col-md-push-1">
					<h4>Contact Information</h4>
					<ul class="fh5co-footer-links">
						<li>Adityapur ,Jamshedpur <br>JH  INDIA 831012</li>
						<li><a href="tel://1234567920">+ 1235 2355 98</a></li>
						<li><a href="mailto:info@yoursite.com">email : ApnaOPD</a></li>
					</ul>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block">&copy; 2018 ApnaOPD. All Rights Reserved.</small> 
						<!-- <small class="block">Designed by <a href="http://freehtml5.co/" target="_blank">FreeHTML5.co</a> Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a></small> -->
					</p>
					<p>
						<ul class="fh5co-social-icons">
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li><a href="#"><i class="icon-dribbble"></i></a></li>
						</ul>
					</p>
				</div>
			</div>

		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>
	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>
	<!-- Main -->
	<script src="js/main.js"></script>
	<script src="js/login_module.js"></script>

	<script src="js/jquery.miranda.min.js"></script>
	<script src="js/manage_time_slot.js"></script>


	<script>
		
		$("input[type=radio]").attr("disabled", true);
		var dept = sessionStorage.getItem('department');

		$('#booking_info').modal({ show : false });

		        $.ajax({
		            type        : 'GET', 
		            url         : 'http://192.168.43.193:3000/api/doctors/filter?department=' + dept
		            //data        : formData,
		            //dataType    : 'json',
		            //encode      : true
		        })
		        .done(function(data) {
		        	//var address = data.address;
		        	for (i=0;i<data.length;i++){
		            var address = data[i].address.city+" ," + data[i].address.state+ " ,"+data[i].address.pincode;
		            data[i].addr=address;
		        	}
		            console.log(data);
		            // $.each(data, function(index, element) {
		            // 	$('.desc').append($('<h3>', {
		            // 		text : element.address.state
		            // 	}, '</h3>'));
		            // });

		            $("#doctors").mirandajs(data);
		            // $("#doctors").mirandajs(address);

		        });

		        //event.preventDefault();
			
			

		function getTimeSlab(id) {
			$.get("http://192.168.43.193:3000/api/doctors/"+id, function(res) {
				//get doctor's time slab
				var slab = ["3110000","3120000","3130000","3210000"];
				var day = $("#day option:selected").text();
				var period = $("#period option:selected").text();
				console.log(period);
				var decoded_time_slab = select_time_slot(day, period, slab);
				console.log("Decode",decoded_time_slab);
				if(period == "morning") {
					$("#afternoon").hide();
					$("#morning").show();
					$("#evening").hide();
					$("#night").hide();
					for(i=0;i<decoded_time_slab.length;i++)
					{
						if(decoded_time_slab[i]==1)
						{
							$("#m"+i).attr("disabled", false);
						}
						else
						{
							$("#m"+i).attr("disabled", true);
						}
					}
				}
				else if(period == "afternoon") {
					$("#afternoon").show();
					$("#morning").hide();
					$("#evening").hide();
					$("#night").hide();
					for(i=0;i<decoded_time_slab.length;i++)
					{
						if(decoded_time_slab[i]==1)
						{
							$("#a"+i).attr("disabled", false);
						}
						else
						{
							$("#a"+i).attr("disabled", true);
						}
					}
				}
				else if(period == "evening") {
					$("#afternoon").hide();
					$("#morning").hide();
					$("#evening").show();
					$("#night").hide();
					for(i=0;i<decoded_time_slab.length;i++)
					{
						if(decoded_time_slab[i]==1)
						{
							$("#e"+i).attr("disabled", false);
						}
						else{
							$("#e"+i).attr("disabled", true);
						}
					}
				}
				else if(period == "night") {
					$("#afternoon").hide();
					$("#morning").hide();
					$("#evening").hide();
					$("#night").show();
					for(i=0;i<decoded_time_slab.length;i++)
					{
						if(decoded_time_slab[i]==1)
						{
							$("#n"+i).attr("disabled", false);
						}
						else
						{
							$("#n"+i).attr("disabled", true);
						}
					}
				}
			});
			
		}
		

		function book_appointment(selected_docid) {
			//alert("Appointment booked!");

			//$(this.'#doctor_id').attr('id', 'selectedDoc');
			var formData = {
				casesheet_uid : sessionStorage.getItem('cid'),
				patient_gid : sessionStorage.getItem('patient_gid'),
				doctor_gid : selected_docid,
				time_slab : "1100110"
			}

			var selected_radio = $("input[name=select]:checked").val();
			console.log("radio", selected_radio);
			if(selected_radio!=undefined) {
			console.log(formData);

			$.ajax({
		            type        : 'POST', 
		            url         : 'http://192.168.43.193:3000/api/appointments',
		            data        : formData,
		            dataType    : 'json',
		            encode      : true
		        })
		        .done(function(data) {
					console.log(data);
					$('#booking_info').modal('show');
 					$("#m_body").mirandajs(data);

				});
			//window.location.href = "profile_patient.html";
			}
			else {
				alert("Please select a time slab!!!");
			}
		}
	</script>
	</body>
</html>