<!DOCTYPE HTML>
<html>
	<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>ApnaOPD</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="Free HTML5 Website Template by freehtml5.co" />
	<meta name="keywords" content="free website templates, free html5, free template, free bootstrap, free website template, html5, css3, mobile first, responsive" />
	<meta name="author" content="freehtml5.co" />

  	<!-- Facebook and Twitter integration -->
	<meta property="og:title" content=""/>
	<meta property="og:image" content=""/>
	<meta property="og:url" content=""/>
	<meta property="og:site_name" content=""/>
	<meta property="og:description" content=""/>
	<meta name="twitter:title" content="" />
	<meta name="twitter:image" content="" />
	<meta name="twitter:url" content="" />
	<meta name="twitter:card" content="" />

	<!-- <link href="https://fonts.googleapis.com/css?family=Work+Sans:300,400,500,700,800" rel="stylesheet">	 -->
	<link href="https://fonts.googleapis.com/css?family=Space+Mono" rel="stylesheet">
	
	<!-- Animate.css -->
	<link rel="stylesheet" href="css/animate.css">
	<!-- Icomoon Icon Fonts-->
	<link rel="stylesheet" href="css/icomoon.css">
	<!-- Bootstrap  -->
	<link rel="stylesheet" href="css/bootstrap.css">

	<!-- Magnific Popup -->
	<link rel="stylesheet" href="css/magnific-popup.css">

	<!-- Flexslider  -->
	<link rel="stylesheet" href="css/flexslider.css">

	<!-- Theme style  -->
	<link rel="stylesheet" href="css/style.css">

	<!-- Modernizr JS -->
	<script src="js/modernizr-2.6.2.min.js"></script>
	<!-- FOR IE9 below -->
	<!--[if lt IE 9]>
	<script src="js/respond.min.js"></script>
	<![endif]-->


	<style>
		#visitorList::-webkit-scrollbar {
		    width: 6px;
		}

		/* Track */
		#visitorList::-webkit-scrollbar-track {
		    box-shadow: inset 0 0 5px grey; 
		    border-radius: 10px;
		}
		 
		/* Handle */
		#visitorList::-webkit-scrollbar-thumb {
		    background: green; 
		    border-radius: 10px;
		}

		/* Handle on hover */
		#visitorList::-webkit-scrollbar-thumb:hover {
		    background: #b30000; 
		}

		#visitor_body , #history_body {
			border: 1px solid #ddd;
			padding: 20px;
			margin-bottom: 15px;
		}

		#historyList::-webkit-scrollbar {
		    width: 6px;
		}

		/* Track */
		#historyList::-webkit-scrollbar-track {
		    box-shadow: inset 0 0 5px grey; 
		    border-radius: 10px;
		}
		 
		/* Handle */
		#historyList::-webkit-scrollbar-thumb {
		    background: green; 
		    border-radius: 10px;
		}

		/* Handle on hover */
		#historyList::-webkit-scrollbar-thumb:hover {
		    background: #b30000; 
		}

		.nav-tabs li {
			width: 25%;
			text-align: center;
			font-size: 20px;
			font-weight: bold;
		}

		.nav-tabs li.active a {
			color: #00960c;
		}

		.nav-tabs li a {
			color: #000;
		}
	</style>
	</head>
	<body>
		
	<div class="fh5co-loader"></div>
	
	<div id="page">
	<nav class="fh5co-nav" role="navigation">
		<div class="top-menu">
			<div class="container-fluid">
				<div class="row">
					<div class="col-xs-2">
						<div id="fh5co-logo"><a href="index.html">ApnaOPD</a></div>
					</div>
					<div class="col-xs-10 text-right menu-1">
						<ul>
							<li><a href="index.html">Home</a></li>
							<!-- <li><a href="product.html">Product</a></li> -->
							<li><a onclick="patient_login()" href="#" >Patient</a></li>
							<li class="active"><a onclick="doctor_login()" href="#">Doctor</a></li>
							<li><a onclick="retailer_login()" href="#">Retailer</a></li>
							
						</ul>
					</div>
				</div>
				
			</div>
		</div>
	</nav>
	
<div class="container-fluid">
<ul class="nav nav-tabs">
    <li class="active"><a data-toggle="tab" href="#visitors">Visitors</a></li>
    <li><a data-toggle="tab" href="#history">History</a></li>
    <li><a data-toggle="tab" href="#time-slab">Manage Time Slab</a></li>
    <li><a data-toggle="tab" href="#profile">Profile</a></li>
  </ul>

  <div class="tab-content">
    <div id="visitors" class="tab-pane fade in active">
      <div id="fh5co-about">
		<div class="container">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<h2>Visitors</h2>
					<!-- <p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p> -->
				</div>
			</div>
			<div class="row">
				<div class="member">
					<div class="col-md-1 nopadding animate-box">
					</div>
					<div class="col-md-10 nopadding animate-box" style="border: 1px solid #000;">
						<div id="visitorList" class="desc" style="margin-top:1em;height: 600px;margin-top:0;padding:1em;width:100%; overflow-y: auto;">
							<div id="visitor_body">
							<div class="row">
								<div class="col-md-9">
									<h3>[[patient_name]]</h3>
									<p>[[patient_age]]</p>
									<p>[[visitingTime]]</p>
								</div>
								<div class="col-md-3">
									<a href="patient_detail.html"><button class="btn btn-primary" onclick="showPatient(this.id)" id="[[casesheet_uid]]">View details</button></a>
								</div>
							</div>
							</div>
						</div>
					</div>
					<div class="col-md-1 nopadding animate-box">
					</div>
				</div>
				
				
			</div>
		</div>
	</div>
    </div>
    <div id="history" class="tab-pane fade">
      <div id="fh5co-about">
		<div class="container">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<h2>History</h2>
					<!-- <p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p> -->
				</div>
			</div>
			<div class="row">
				<div class="member">
					<div class="col-md-1 nopadding animate-box">
					</div>
					<div class="col-md-10 nopadding animate-box" style="border: 1px solid #000;">
						<div id="historyList" class="desc" style="margin-top:1em;height: 600px;margin-top:0;padding:1em;width:100%; overflow-y: auto;">
							<div id="history_body">
							<div class="row">
								<div class="col-md-9">
									<h3>[[patient_name]]</h3>
									<p>[[patient_age]]</p>
									<p>[[visitingTime]]</p>
								</div>
								<div class="col-md-3">
									<a href="#"><button class="btn btn-primary">View details</button></a>
								</div>
							</div>
							</div>
						</div>
					</div>
					<div class="col-md-1 nopadding animate-box">
					</div>
				</div>
				
				
			</div>
		</div>
	</div>

    </div>
    <div id="time-slab" class="tab-pane fade">
      <div id="fh5co-about">
		<div class="container">
			<div class="row animate-box">
				<div class="col-md-8 col-md-offset-2 text-center fh5co-heading">
					<h2>Time Slab</h2>
					<!-- <p>Dignissimos asperiores vitae velit veniam totam fuga molestias accusamus alias autem provident. Odit ab aliquam dolor eius.</p> -->
				</div>
			</div>
			<div class="row">
				<div class="member">
					<div class="row">
						<div class="form-group">
							<label for="days">Select day:</label>
							<select class="form-control" id="days" onchange="timeUpdate(this.value)">
								<option value="1" selected>Monday</option>
								<option value="2">Tuesday</option>
								<option value="3">Wednesday</option>
								<option value="4">Thursday</option>
								<option value="5">Friday</option>
								<option value="6">Saturday</option>
								<option value="7">Sunday</option>
							</select>
						</div> 
					</div>
					<div class="row" style="margin-top : 30px">
						<div class="col-md-2">
							<h4>Morning : </h4>
						</div>
						<div class="col-md-10">
							<form id="morning">
								<label class="checkbox-inline">
									<input type="checkbox" id="m0" name="m0" value="1">6:00 AM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="m1" name="m1" value="2">7:00 AM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="m2" name="m2" value="3">8:00 AM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="m3" name="m3" value="4">9:00 AM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="m4" name="m4" value="5">10:00 AM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="m5" name="m5" value="6">11:00 AM
								</label>
							</form>
						</div>
					</div>
					<div class="row" style="margin-top : 30px">
						<div class="col-md-2">
							<h4>Afternoon : </h4>
						</div>
						<div class="col-md-10">
							<form id="afternoon">
								<label class="checkbox-inline">
									<input type="checkbox" id="a0" value="1">12:00 PM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="a1" value="2">1:00 PM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="a2" value="3">2:00 PM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="a3" value="4">3:00 PM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="a4" value="5">4:00 PM
								</label>
								<label class="checkbox-inline">
									<input type="checkbox" id="a5" value="6">5:00 PM
								</label>
							</form>
						</div>
					</div>
					<div class="row" style="margin-top : 30px">
							<div class="col-md-2">
									<h4>Evening : </h4>
								</div>
								<div class="col-md-10">
									<form id="evening">
										<label class="checkbox-inline">
											<input type="checkbox" id="e0" value="1">6:00 PM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="e1" value="2">7:00 PM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="e2" value="3">8:00 PM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="e3" value="4">9:00 PM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="e4" value="5">10:00 PM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="e5" value="6">11:00 PM
										</label>
									</form>
								</div>
					</div>
					<div class="row" style="margin-top : 30px">
							<div class="col-md-2">
									<h4>Night : </h4>
								</div>
								<div class="col-md-10">
									<form id="night">
										<label class="checkbox-inline">
											<input type="checkbox" id="n0" value="1">12:00 AM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="n1" value="2">1:00 AM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="n2" value="3">2:00 AM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="n3" value="4">3:00 AM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="n4" value="5">4:00 AM
										</label>
										<label class="checkbox-inline">
											<input type="checkbox" id="n5"value="6">5:00 AM
										</label>
									</form>
								</div>
					</div>
					<!-- <div class="text-right"><button class="btn btn-primary" onclick="updateTime()">Update Time </button></div> -->
				</div>
				
				
			</div>
		</div>
	</div>
    </div>
    <div id="profile" class="tab-pane fade">
      <h3>Menu 3</h3>
      <p>Eaque ipsa quae ab illo inventore veritatis et quasi architecto beatae vitae dicta sunt explicabo.</p>
    </div>
  </div>
</div> 


    <footer id="fh5co-footer" role="contentinfo">
		<div class="container">
			<div class="row row-pb-md">
				<div class="col-md-4 fh5co-widget">
					<h4>ApnaOPD</h4>
					<p>Facilis ipsum reprehenderit nemo molestias. Aut cum mollitia reprehenderit. Eos cumque dicta adipisci architecto culpa amet.</p>
				</div>
				<div class="col-md-4 col-md-push-1">
					<h4>Links</h4>
					<ul class="fh5co-footer-links">
						<li><a href="index.html">Home</a></li>
						<li><a href="#">About us</a></li>
					</ul>
				</div>

				<div class="col-md-4 col-md-push-1">
					<h4>Contact Information</h4>
					<ul class="fh5co-footer-links">
						<li>Adityapur ,Jamshedpur <br>JH  INDIA 831012</li>
						<li><a href="tel://1234567920">+ 1235 2355 98</a></li>
						<li><a href="mailto:info@yoursite.com">email : ApnaOPD</a></li>
					</ul>
				</div>

			</div>

			<div class="row copyright">
				<div class="col-md-12 text-center">
					<p>
						<small class="block">&copy; 2018 ApnaOPD. All Rights Reserved.</small> 
						<!-- <small class="block">Designed by <a href="http://freehtml5.co/" target="_blank">FreeHTML5.co</a> Demo Images: <a href="http://unsplash.co/" target="_blank">Unsplash</a></small> -->
					</p>
					<p>
						<ul class="fh5co-social-icons">
							<li><a href="#"><i class="icon-facebook"></i></a></li>
							<li><a href="#"><i class="icon-linkedin"></i></a></li>
							<li><a href="#"><i class="icon-dribbble"></i></a></li>
						</ul>
					</p>
				</div>
			</div>

		</div>
	</footer>
	</div>

	<div class="gototop js-top">
		<a href="#" class="js-gotop"><i class="icon-arrow-up"></i></a>
	</div>
	
	<!-- jQuery -->
	<script src="js/jquery.min.js"></script>
	<!-- jQuery Easing -->
	<script src="js/jquery.easing.1.3.js"></script>
	<!-- Bootstrap -->
	<script src="js/bootstrap.min.js"></script>
	<!-- Waypoints -->
	<script src="js/jquery.waypoints.min.js"></script>
	<!-- Flexslider -->
	<script src="js/jquery.flexslider-min.js"></script>
	<!-- Magnific Popup -->
	<script src="js/jquery.magnific-popup.min.js"></script>
	<script src="js/magnific-popup-options.js"></script>
	<!-- Main -->
	<script src="js/main.js"></script>
	<script src="js/login_module.js"></script>

	<script src="js/jquery.miranda.min.js"></script>
	<script src="js/enc_dec_time.js"></script>
	<script src="js/manage_time_slot.js"></script>


<script>

var docid = sessionStorage.getItem('doctor_gid');
$.ajax({

        type        : 'GET', 
        url         : 'http://192.168.43.193:3000/api/appointments/doctor/visiting/'+docid
    })
    .done(function(data) {
    	
		for(i=0;i<data.length;i++)
		{
			
			data[i].visitingTime = get_time(data[i].time_slab);
			//console.log(i,data[i]);
		}
		console.log('visitor list', data);
    	$('#visitorList').mirandajs(data);
    	
});

function showPatient(pid) {
	sessionStorage.setItem('show_pid', pid);
	window.location.href = "patient_detail.html";
}

$.ajax({
    type        : 'GET', 
    url         : 'http://192.168.43.193:3000/api/appointments/doctor/history/'+docid
    //data        : e_presc,
    //dataType    : 'json',
    //encode      : true
})
.done(function(data) {
	//console.log(data);
	$('#historyList').mirandajs(data);
	
});

//var decoded_time;

timeUpdate($("#days").val());

function timeUpdate(selected_day) {
	//console.log("day", selected_day);
	var time_slab;
	$.get("http://192.168.43.193:3000/api/doctors/" + docid , function(res){
	//console.log("doctor", res);
	time_slab = res.time_slab;
	});
	var timeSlab = ["1110000","1220000","2220000","2230000"];
	var decoded_time = get_time_slot(timeSlab);
	if(selected_day == 1) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.monday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.monday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.monday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.monday.night[i]));
		}
	}
	else if(selected_day == 2) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.tuesday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.tuesday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.tuesday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.tuesday.night[i]));
		}
	}
	else if(selected_day == 3) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.wednesday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.wednesday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.wednesday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.wednesday.night[i]));
		}
	}
	else if(selected_day == 4) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.thursday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.thursday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.thursday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.thursday.night[i]));
		}
	}
	else if(selected_day == 5) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.friday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.friday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.friday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.friday.night[i]));
		}
	}
	else if(selected_day == 6) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.saturday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.saturday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.saturday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.saturday.night[i]));
		}
	}
	else if(selected_day == 7) {
		for(i=0;i<6;i++)
		{
			$("#m"+i).prop('checked',parseInt(decoded_time.sunday.morning[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#a"+i).prop('checked',parseInt(decoded_time.sunday.afternoon[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#e"+i).prop('checked',parseInt(decoded_time.sunday.evening[i]));
		}
		for(i=0;i<6;i++)
		{
			$("#n"+i).prop('checked',parseInt(decoded_time.sunday.night[i]));
		}
	}
}

function updateTime() {
	var time_slab = [];
	var day = $("#days").val();
	var morning = "1", afternoon = "2", evening = "3", night = "4";
	var val_morning = $("#morning").serializeArray();
	console.log(val_morning);
	var x
	var index=0;
	for(i=0;i<6;i++)
	{
		x=day+morning;
		if($("#m"+i+":checked"))
		{
			x+=$("#m"+i).val();
			//console.log(i,$("#m"+i).val());
			time_slab[index].push(x);
		}
		
	}
	index++;
	for(i=0;i<6;i++)
	{
		x=day+afternoon;
		if($("#a"+i+":checked"))
		{
			x+=$("#a"+i).val();
			//console.log(i,$("#a"+i).val());
			time_slab[index].push(x);
		}
		
	}
	index++;
	for(i=0;i<6;i++)
	{
		x=day+evening;
		if($("#e"+i+":checked"))
		{
			x+=$("#e"+i).val();
			//console.log(i,$("#e"+i).val());
			time_slab[index].push(x);
		}
		
	}
	index++;
	for(i=0;i<6;i++)
	{
		x=day+night;
		if($("#n"+i+":checked"))
		{
			x+=$("#n"+i).val();
			//console.log(i,$("#n"+i).val());
			time_slab[index].push(x);
		}
		
	}
	console.log(time_slab);
}

</script>
</body>
</html>